import{r,j as e,b as N,t as v,e as y,c as S,R as w,a as C,d as k,u as E}from"./styles-mUuRymAq.js";import{f as b}from"./time-Bu1cAEOJ.js";function I({settings:s,onSave:m}){const[a,l]=r.useState(s),[n,c]=r.useState(!1),[x,d]=r.useState("idle"),o=async t=>{t.preventDefault(),c(!0),d("idle");try{await m(a),d("success"),setTimeout(()=>d("idle"),2e3)}catch(u){console.error("Failed to save settings",u),d("error")}finally{c(!1)}},h=t=>{const u=t.split(`
`).filter(i=>i.trim());l({...a,ignoredDomains:u})};return e.jsxs("form",{onSubmit:o,className:"space-y-6",children:[e.jsx("div",{children:e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.indexingEnabled,onChange:t=>l({...a,indexingEnabled:t.target.checked}),className:`w-5 h-5 rounded border-gray-700 bg-secondary text-primary 
                     focus:ring-2 focus:ring-primary`}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Enable Indexing"}),e.jsx("div",{className:"text-sm text-muted",children:"Allow the extension to index and summarize your browsing history"})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 font-medium",children:"Ignored Domains"}),e.jsx("textarea",{value:a.ignoredDomains.join(`
`),onChange:t=>h(t.target.value),placeholder:`example.com
social-media.com`,rows:5,className:"textarea"}),e.jsx("p",{className:"text-sm text-muted mt-1",children:"One domain per line"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 font-medium",children:"Preferred Language"}),e.jsxs("select",{value:a.preferredLanguage,onChange:t=>l({...a,preferredLanguage:t.target.value}),className:"input",children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"es",children:"Spanish"}),e.jsx("option",{value:"fr",children:"French"}),e.jsx("option",{value:"de",children:"German"}),e.jsx("option",{value:"ja",children:"Japanese"}),e.jsx("option",{value:"zh",children:"Chinese"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 font-medium",children:"Max Pages Per Day"}),e.jsx("input",{type:"number",min:"10",max:"1000",value:a.maxPagesPerDay,onChange:t=>l({...a,maxPagesPerDay:parseInt(t.target.value)}),className:"input"}),e.jsx("p",{className:"text-sm text-muted mt-1",children:"Maximum number of pages to index per day (10-1000)"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:n,className:"btn btn-primary",children:n?"Saving...":"Save Settings"}),x==="success"&&e.jsx("div",{className:"flex items-center text-green-500 text-sm",children:"✓ Settings saved"}),x==="error"&&e.jsx("div",{className:"flex items-center text-red-500 text-sm",children:"✗ Failed to save"})]})]})}function D({stats:s,isLoading:m,onRefresh:a}){const l=n=>n<1024?`${n} B`:n<1048576?`${(n/1024).toFixed(1)} KB`:`${(n/1048576).toFixed(2)} MB`;return m?e.jsx("div",{className:"card",children:e.jsxs("div",{className:"animate-skeleton",children:[e.jsx("div",{className:"h-6 bg-slate-700 rounded w-1/3 mb-4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-slate-700 rounded w-full"}),e.jsx("div",{className:"h-4 bg-slate-700 rounded w-5/6"}),e.jsx("div",{className:"h-4 bg-slate-700 rounded w-4/6"})]})]})}):s?e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Database Statistics"}),e.jsx("button",{onClick:a,className:"btn btn-secondary text-sm",children:"Refresh"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:s.totalPages}),e.jsx("div",{className:"text-sm text-muted",children:"Total Pages"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-500",children:s.summarizedPages}),e.jsx("div",{className:"text-sm text-muted",children:"Summarized"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-500",children:s.queuedPages}),e.jsx("div",{className:"text-sm text-muted",children:"Queued"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-red-500",children:s.failedPages}),e.jsx("div",{className:"text-sm text-muted",children:"Failed"})]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700 space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted",children:"Database Size:"}),e.jsx("span",{children:l(s.estimatedSize)})]}),s.lastScanTime&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted",children:"Last Scan:"}),e.jsx("span",{children:b(s.lastScanTime)})]}),s.oldestRecord&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted",children:"Oldest Record:"}),e.jsx("span",{children:b(s.oldestRecord)})]}),s.newestRecord&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted",children:"Newest Record:"}),e.jsx("span",{children:b(s.newestRecord)})]})]})]}):e.jsx("div",{className:"card",children:e.jsx("p",{className:"text-muted",children:"Failed to load stats"})})}function T({onDataErased:s}){const[m,a]=r.useState(!1),[l,n]=r.useState(!1),[c,x]=r.useState(!1),[d,o]=r.useState(!1),h=()=>{a(!0)},t=async()=>{n(!0);try{await y(),a(!1),s(),alert("All data has been erased successfully")}catch(g){console.error("Failed to erase data",g),alert("Failed to erase data")}finally{n(!1)}},u=()=>{a(!1)},i=async()=>{o(!0);try{await N(),alert(`Test data seeded successfully! You can now search for:
• "content planning"
• "AI pricing"
• "HubSpot shortcuts"`),s()}catch(g){console.error("Failed to seed test data",g),alert("Failed to seed test data")}finally{o(!1)}},p=async()=>{x(!0);try{await v(),alert("Scan triggered successfully. Check back in a few minutes.")}catch(g){const j=g instanceof Error?g.message:"Unknown error";console.error("Scan failed:",g),j.includes("AI is not ready")?alert(`Chrome AI is not ready yet.

1. Enable flags at chrome://flags
2. Wait 5-10 minutes for model download
3. Check chrome://components for "Optimization Guide"`):j.includes("Indexing is disabled")?alert("Indexing is disabled. Please enable it in the settings above."):alert(`Scan failed: ${j}

Check the service worker console for details.`)}finally{x(!1)}};return e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Data Management"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Seed Test Data"}),e.jsx("p",{className:"text-sm text-muted mb-3",children:'Add 3 sample pages to test the extension. Works without AI! Search for "content planning" or "AI pricing" after seeding.'}),e.jsx("button",{onClick:i,disabled:d,className:"btn btn-primary",children:d?"Seeding...":"Add Test Data"})]}),e.jsxs("div",{className:"border-t border-gray-700 pt-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Trigger Scan"}),e.jsx("p",{className:"text-sm text-muted mb-3",children:"Manually trigger a scan of your recent browsing history. This will index new pages and update existing ones. (Requires AI to be available)"}),e.jsx("button",{onClick:p,disabled:c,className:"btn btn-primary",children:c?"Scanning...":"Trigger Scan Now"})]}),e.jsxs("div",{className:"border-t border-gray-700 pt-4",children:[e.jsx("h4",{className:"font-medium mb-2 text-red-400",children:"Danger Zone"}),e.jsx("p",{className:"text-sm text-muted mb-3",children:"Permanently delete all indexed pages and settings. This action cannot be undone."}),m?e.jsxs("div",{className:"p-3 bg-red-900/30 border border-red-700 rounded",children:[e.jsx("p",{className:"text-sm mb-3",children:"Are you sure? This will permanently delete all indexed pages and settings."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:t,disabled:l,className:"btn btn-danger text-sm",children:l?"Erasing...":"Yes, Erase Everything"}),e.jsx("button",{onClick:u,disabled:l,className:"btn btn-secondary text-sm",children:"Cancel"})]})]}):e.jsx("button",{onClick:h,className:"btn btn-danger",children:"Erase All Data"})]})]})]})}function A(){const[s,m]=r.useState(null),[a,l]=r.useState(null),[n,c]=r.useState(!0),[x,d]=r.useState(!0),o=async()=>{c(!0);try{const i=await C();m(i)}catch(i){console.error("Failed to load settings",i)}finally{c(!1)}},h=async()=>{d(!0);try{const i=await k();l(i)}catch(i){console.error("Failed to load stats",i)}finally{d(!1)}};r.useEffect(()=>{o(),h()},[]);const t=async i=>{await E(i),await o()},u=()=>{h(),o()};return n?e.jsx("div",{className:"min-h-screen bg-background text-foreground p-8",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"animate-skeleton",children:[e.jsx("div",{className:"h-10 bg-slate-700 rounded w-1/3 mb-8"}),e.jsx("div",{className:"h-64 bg-slate-700 rounded"})]})})}):e.jsx("div",{className:"min-h-screen bg-background text-foreground p-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Talk To Your History"}),e.jsx("p",{className:"text-muted",children:"Configure your private, on-device history search powered by Chrome Built-in AI"})]}),e.jsxs("div",{className:"card mb-6 bg-blue-900/20 border border-blue-700",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"⚙️ Chrome Built-in AI Setup Required"}),e.jsx("p",{className:"text-sm text-muted mb-2",children:"To use this extension, you need to enable Chrome's Built-in AI features:"}),e.jsxs("ol",{className:"text-sm text-muted space-y-1 list-decimal list-inside ml-2",children:[e.jsxs("li",{children:["Open ",e.jsx("code",{className:"bg-slate-800 px-1 rounded",children:"chrome://flags"})," in a new tab"]}),e.jsxs("li",{children:["Enable: ",e.jsx("code",{className:"bg-slate-800 px-1 rounded",children:"#optimization-guide-on-device-model"})]}),e.jsxs("li",{children:["Enable: ",e.jsx("code",{className:"bg-slate-800 px-1 rounded",children:"#prompt-api-for-gemini-nano"})]}),e.jsxs("li",{children:["Enable: ",e.jsx("code",{className:"bg-slate-800 px-1 rounded",children:"#summarization-api-for-gemini-nano"})]}),e.jsxs("li",{children:["Enable: ",e.jsx("code",{className:"bg-slate-800 px-1 rounded",children:"#translation-api"})]}),e.jsxs("li",{children:["Enable: ",e.jsx("code",{className:"bg-slate-800 px-1 rounded",children:"#rewriter-api"})]}),e.jsx("li",{children:"Restart Chrome and wait for Gemini Nano model to download (5-10 minutes)"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Settings"}),s&&e.jsx(I,{settings:s,onSave:t})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Statistics"}),e.jsx(D,{stats:a,isLoading:x,onRefresh:h})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Management"}),e.jsx(T,{onDataErased:u})]}),e.jsxs("div",{className:"card bg-green-900/20 border border-green-700",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"🔒 Privacy First"}),e.jsxs("ul",{className:"text-sm text-muted space-y-1 list-disc list-inside ml-2",children:[e.jsx("li",{children:"All AI processing happens on your device using Gemini Nano"}),e.jsx("li",{children:"No data is sent to external servers"}),e.jsx("li",{children:"Incognito sessions are never indexed"}),e.jsx("li",{children:"You can erase all data at any time"})]})]}),e.jsxs("div",{className:"mt-8 text-center text-sm text-muted",children:[e.jsx("p",{children:"Talk To Your History v0.1.0"}),e.jsx("p",{className:"mt-1",children:"Built for Chrome Built-in AI Challenge 2025"})]})]})})}const f=document.getElementById("root");f&&S(f).render(e.jsx(w.StrictMode,{children:e.jsx(A,{})}));
